---
title: é€šè¿‡ Docker Compose éƒ¨ç½² Mr.ğŸ†– AI
description: å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Docker Compose éƒ¨ç½² Mr.ğŸ†– AI æœåŠ¡ï¼ŒåŒ…æ‹¬å®‰è£… Docker å®¹å™¨ç¯å¢ƒå’Œè‡ªåŠ¨æ›´æ–°è„šæœ¬è®¾ç½®ã€‚
tags:
  - Docker Compose
  - Mr.ğŸ†– AI
  - Docker å®¹å™¨
  - è‡ªåŠ¨æ›´æ–°è„šæœ¬
  - éƒ¨ç½²æŒ‡å¼•
---

# Docker Compose éƒ¨ç½²æŒ‡å¼•

<div style={{display:"flex", gap: 4}}>

[![](https://img.shields.io/docker/v/lobehub/lobe-chat?color=369eff&label=docker&labelColor=black&logo=docker&logoColor=white&style=flat-square)](https://hub.docker.com/r/lobehub/lobe-chat)

[![](https://img.shields.io/docker/image-size/lobehub/lobe-chat?color=369eff&labelColor=black&style=flat-square)](https://img.shields.io/docker/image-size/lobehub/lobe-chat?color=369eff&labelColor=black&style=flat-square)

[![](https://img.shields.io/docker/pulls/lobehub/lobe-chat?color=45cc11&labelColor=black&style=flat-square)](https://img.shields.io/docker/pulls/lobehub/lobe-chat?color=45cc11&labelColor=black&style=flat-square)

</div>

æˆ‘ä»¬æä¾›äº† [Docker é•œåƒ](https://hub.docker.com/r/lobehub/lobe-chat) ï¼Œä¾›ä½ åœ¨è‡ªå·±çš„ç§æœ‰è®¾å¤‡ä¸Šéƒ¨ç½² Mr.ğŸ†– AI æœåŠ¡ã€‚

<Steps>

### å®‰è£… Docker å®¹å™¨ç¯å¢ƒ

ï¼ˆå¦‚æœå·²å®‰è£…ï¼Œè¯·è·³è¿‡æ­¤æ­¥ï¼‰

<Tabs items={['Ubuntu', 'CentOS']}>

<Tab>

```fish
$ apt install docker.io
```

</Tab>

<Tab>

```fish
$ yum install docker
```

</Tab>

</Tabs>

### è¿è¡Œ Docker Compose éƒ¨ç½²æŒ‡ä»¤

ä½¿ç”¨ `docker-compose` æ—¶é…ç½®æ–‡ä»¶å¦‚ä¸‹:

```yml
version: '3.8'

services:
  lobe-chat:
    image: lobehub/lobe-chat
    container_name: lobe-chat
    restart: always
    ports:
      - '3210:3210'
    environment:
      OPENAI_API_KEY: sk-xxxx
      OPENAI_PROXY_URL: https://api-proxy.com/v1
      ACCESS_CODE: lobe66
```

è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Lobe Chat æœåŠ¡ï¼š

```bash
$ docker-compose up -d
```

### Crontab è‡ªåŠ¨æ›´æ–°è„šæœ¬ï¼ˆå¯é€‰ï¼‰

ç±»ä¼¼åœ°ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬æ¥è‡ªåŠ¨æ›´æ–° Lobe Chatï¼Œä½¿ç”¨ `Docker Compose` æ—¶ï¼Œç¯å¢ƒå˜é‡æ— éœ€é¢å¤–é…ç½®ã€‚

```bash
#!/bin/bash
# auto-update-lobe-chat.sh

# Set proxy (optional)
export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890

# Pull the latest image and store the output in a variable
output=$(docker pull lobehub/lobe-chat:latest 2>&1)

# Check if the pull command was executed successfully
if [ $? -ne 0 ]; then
  exit 1
fi

# Check if the output contains a specific string
echo "$output" | grep -q "Image is up to date for lobehub/lobe-chat:latest"

# If the image is already up to date, do nothing
if [ $? -eq 0 ]; then
  exit 0
fi

echo "Detected Lobe-Chat update"

# Remove the old container
echo "Removed: $(docker rm -f Lobe-Chat)"

# You may need to navigate to the directory where `docker-compose.yml` is located first
# cd /path/to/docker-compose-folder

# Run the new container
echo "Started: $(docker-compose up)"

# Print the update time and version
echo "Update time: $(date)"
echo "Version: $(docker inspect lobehub/lobe-chat:latest | grep 'org.opencontainers.image.version' | awk -F'"' '{print $4}')"

# Clean up unused images
docker images | grep 'lobehub/lobe-chat' | grep -v 'lobehub/lobe-chat-database' | grep -v 'latest' | awk '{print $3}' | xargs -r docker rmi > /dev/null 2>&1
echo "Removed old images."
```

This script can also be used in Crontab, but ensure that your Crontab can find the correct Docker command. It is recommended to use absolute paths.

Configure Crontab to execute the script every 5 minutes:

```bash
*/5 * * * * /path/to/auto-update-lobe-chat.sh >> /path/to/auto-update-lobe-chat.log 2>&1
```

</Steps>
